{% extends "ProcesoBundle:All:Especialista/layout.html.twig" %}

{% block body %}

<div class="container" class="container" ng-app="addProcessModule" ng-controller="addProcessController">

  <div class="content">

    <div class="content-container">

      <div class="content-header">
        <h2 class="content-header-title">Agregar nuevo proceso</h2>
      </div> <!-- /.content-header -->
      <div class="row">
        <div class="col-xs-6"> 
          <label>Nombre del proceso:</label>
          <input type="text" class="form-control" ng-model="procesoNuevo.nombre">
        </div>
        <div class="col-xs-6"> 
          <label>Descripcion:</label>
          <textarea class="form-control" style="height: 82px;"  ng-model="procesoNuevo.descripcion"></textarea>
          <br>
        </div>
      </div>
<!--       <div class="container" align="center"> -->
        <div class="row">
          <!-- <div class="col-xs-2"></div>   -->
          <div class="col-xs-12">
             <div ng-repeat=" (key1, value) in procesoNuevo.actividades" >
                <div class="portlet">
                    <div class="portlet-header">
                      <h3 style="color: #428BCA;font-weight: bold;">Actividad {[{$index+1}]}</h3>
                      <i class="fa fa-times" style="  margin-left: 89%;position: absolute;  cursor: pointer;" ng-click="delete(key1)"></i>
                    </div>
                    <div class="portlet-content">
                      <div class="row">
                              <div class="col-xs-4">
                                 <label>Nombre de la actividad:</label>
                                 <input type="text" class="form-control" ng-model="procesoNuevo.actividades[$index].nombre">
                              </div>
                              <div class="col-xs-4">
                                <label>Responsable:</label>
                                  <select class="form-control" ng-model="procesoNuevo.actividades[$index].idResponsable">
                                      <option value="">Seleccione</option>
                                      <option ng-repeat="value in response.responsables" value="{[{value.id}]}">{[{value.nombre}]} </option>
                                  </select>
                              </div>
                              <div class="col-xs-4">
                                <label>Tiempo:</label>
                                <input type="number" min="0" placeholder="Numero de dÃ­as" class="form-control" ng-model="procesoNuevo.actividades[$index].tiempo">  
                              </div> 
                      </div>
                    <div class="portlet-content">
                      <div class="row">
                        <div class="col-xs-16">
                          <label>Descripcion:</label>
                          <textarea style="height: 90px;" class="form-control"  ng-model="procesoNuevo.actividades[key1].descripcion"></textarea>
                        </div>
                      </div>
                      <hr>
                    </div>
                    </div>
                    <div class="row">
                      <div ng-repeat=" (tarea, valor) in procesoNuevo.actividades[key1].tareas track by $index"  >
                        <div class="col-xs-6">
                          <div class="portlet" style="margin-left: 3%;margin-right: 3%;">
                            <div class="portlet-header">
                              <h3 style="color: #428BCA;font-weight: bold;">Tarea {[{$index+1}]}</h3>
                              <i class="fa fa-times" style="  margin-left: 81%;position: absolute;cursor: pointer;"ng-click="delete(key1,tarea)"></i>
                            </div>
                            <div class="portlet-content">
                              <div class="col-xs-12">
                                  <label>Nombre:</label>
                                    <input class="form-control" type="text" ng-model="procesoNuevo.actividades[key1].tareas[tarea].nombre">
                                    <br>
                                    <label>Tipo de tarea:</label>
                                    <select class="form-control" ng-model="procesoNuevo.actividades[key1].tareas[tarea].tipo"  {#ng-model="procesoNuevo.actividades[$index].tareas[index2].Tipo"#}>
                                    <option value="">Seleccione</option>
                                      <option ng-repeat="value in response.tareas" value="{[{value.id}]}">{[{value.nombre}]} </option>
                                    </select>
                                    <br>
                                    <label>Descripcion:</label>
                                    <textarea class="form-control" ng-model="procesoNuevo.actividades[key1].tareas[tarea].descripcion"></textarea>
                              </div>   
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div align="center">
                      <button type="button" class="btn btn-secondary" ng-click="addTarea();">Agregar Tarea</button>
                    </div>
                    <br>
                </div>
              <br>
              <hr>
              </div>
              <br>
              <div align="center">
                <button type="button" class="btn btn-secondary" ng-click="add();">Agregar Actividad</button>
                <button type="button" class="btn btn-secondary" ng-click="addProcess();">Enviar</button>   
              </div>
          </div>
          <!-- <div class="col-xs-3"></div> -->
        </div>
      </div>
   <!--  </div> --> <!-- /.content-container -->
      
  </div> <!-- /.content -->
</div> <!-- /.container -->

{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
          var response = "{{ information }}";
          var div = document.createElement('div');
          div.innerHTML = response;
          response = div.firstChild.nodeValue;
          response = JSON.parse(response);
          console.log("response",response);
    </script>
   <script src="{{ asset('bundles/proceso/js/angular/addProcess/addProcessModule.js') }}"></script>
   <script src="{{ asset('bundles/proceso/js/angular/addProcess/addProcessController.js') }}"></script>
   <script src="{{ asset('bundles/proceso/js/angular-repeat-n.js') }}"></script>
      <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
   <script src="{{ path('fos_js_routing_js', {'callback': 'fos.Router.setData'}) }}"></script>

{% endblock %}