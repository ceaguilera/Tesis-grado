{% extends "ProcesoBundle:All:Especialista/layout.html.twig" %}

{% block body %}

<div class="container" ng-app="listActivityModule" ng-controller="listActivityController" ng-cloak>

  <div class="content">

    <div class="content-container" id="inicio">

      <div class="content-header">
        <ul class="nav nav-pills">
          <li role="presentation"><a href="" ng-click="redirect()">Editar proceso</a></li>
          <li role="presentation" class="active"><a href="#">Relaciones entre actividades</a></li>
        </ul>
      </div> <!-- /.content-header -->
      <uib-alert dismiss-on-timeout="4000" ng-repeat="alert in alerts" type="{[{alert.type}]}" close="closeAlert($index)"><strong>{[{alert.msg}]}</strong></uib-alert>
      <form name="relaciones" novalidate>
        <div class="row" ng-repeat="(key, value) in response.actividades">
          <div class="col-sm-8 col-md-offset-2" style="background-color: #f3f3f3;  border-radius: 4px;margin-bottom: 2%;">
            <br>
            <div class="row">
              <div align="center"  class="col-md-4"><label>Actividad anterior</label>
              <br><select class="form-control" ng-model="value.actAnt"  number-converter
              required="required" name="actividad1{[{$index}]}" ng-class="{'form-control-error':(relaciones.actividad1{[{$index}]}.$invalid 
                                  && relaciones.$submitted)}">
                <option value="-3">Seleccione</option>
                <option value="-2">Inicio</option>
                <option value="-1">Fin</option>
                <option ng-repeat="(key2, value2) in response.actividades" value="{[{value2.id}]}">{[{value2.nombre}]}</option>
              </select>
              <span 
              class="error" 
              ng-show="relaciones.actividad1{[{$index}]}.$invalid 
              && relaciones.$submitted">
              Este campo es requerido
              </span>
              </div>
              <div align="center" class="col-md-4"><label>Nombre de la actividad</label>
              <br>{[{value.nombre}]}</div>
              <div align="center"  class="col-md-4"><label>Actividad siguiente</label>
              <br><select class="form-control" ng-model="value.actSig" number-converter required="required" name="actividad2{[{$index}]}" ng-class="{'form-control-error':(relaciones.actividad2{[{$index}]}.$invalid 
                                  && relaciones.$submitted)}">
                <option value="-3">Seleccione</option>
                <option value="-2">Inicio</option>
                <option value="-1">Fin</option>
                <option ng-repeat="(key2, value2) in response.actividades" value="{[{value2.id}]}">{[{value2.nombre}]}</option>
              </select>
              <span 
              class="error" 
              ng-show="relaciones.actividad2{[{$index}]}.$invalid 
              && relaciones.$submitted">
              Este campo es requerido
              </span>
              </div>
            </div>
            <br>
          </div>
        </div>
        <br>
      </form>
      <div align="center">
        <button type="submit" class="btn btn-secondary" ng-click="validacion(); addActivity()">Guardar Cambios</button>
      </div>
    </div> <!-- /.content-container -->
      
  </div> <!-- /.content -->
</div> <!-- /.container -->
{#{{dump(task)}}#}
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
          var response = "{{ listActivity }}";
          var div = document.createElement('div');
          div.innerHTML = response;
          response = div.firstChild.nodeValue;
          response = JSON.parse(response);
          console.log("response",response);
    </script>
   <script src="{{ asset('bundles/proceso/js/angular/listActivity/listActivityModule.js') }}"></script>
   <script src="{{ asset('bundles/proceso/js/angular/listActivity/listActivityController.js') }}"></script>
   <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
   <script src="{{ path('fos_js_routing_js', {'callback': 'fos.Router.setData'}) }}"></script>

{% endblock %}